{% extends "base.html" %}
{% block title %}Scan Results{% endblock %}
{% block content %}
<h1><i class="fas fa-clipboard-list"></i> Scan Results</h1>
<div class="card mb-3">
    <div class="card-body">
        <h5>Target: {{ scan.url }}</h5>
        <p><small>Scanned: {{ scan.timestamp[:19] }}</small></p>
        <h2 class="risk-score">Risk Score: {{ scan.risk_score }}/100</h2>
        <span class="badge badge-{{ scan.risk_level|lower }} fs-5">{{ scan.risk_level }}</span>
    </div>
</div>
<div class="card mb-3">
    <div class="card-header bg-info text-white"><h5>Executive Summary</h5></div>
    <div class="card-body"><pre>{{ scan.executive_summary }}</pre></div>
</div>
{% if vulnerabilities %}
<div class="card">
    <div class="card-header bg-danger text-white"><h5>Vulnerabilities ({{ scan.total_vulnerabilities }})</h5></div>
    <div class="card-body">
        {% for vuln in vulnerabilities %}
        <div class="card mb-3">
            <div class="card-header">
                <span class="badge badge-{{ vuln.severity|lower }}">{{ vuln.severity }}</span>
                <strong>{{ vuln.type }}</strong>
            </div>
            <div class="card-body">
                <p><strong>URL:</strong> <code>{{ vuln.url }}</code></p>
                {% if vuln.parameter %}<p><strong>Parameter:</strong> <code>{{ vuln.parameter }}</code></p>{% endif %}
                <p><strong>Description:</strong> {{ vuln.description }}</p>
                <div class="alert alert-info">
                    <h6>Mitigation:</h6>
                    <p>{{ vuln.mitigation.summary }}</p>
                    <ul>{% for rec in vuln.mitigation.recommendations[:3] %}<li>{{ rec }}</li>{% endfor %}</ul>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% else %}
<div class="alert alert-success"><i class="fas fa-check-circle"></i> No vulnerabilities found!</div>
{% endif %}
{% endblock %}
